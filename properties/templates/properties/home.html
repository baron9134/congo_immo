{% extends 'properties/base.html' %}

{% block content %}
<div class="flex flex-col md:flex-row">

    <!-- Sidebar de filtre -->
    <div class="w-full md:w-1/4 p-4 bg-white rounded shadow mb-6 md:mb-0 md:mr-6">
        <form method="get">
            <h2 class="text-xl font-semibold mb-4">Filtres</h2>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-1">Titre</label>
                <input type="text" name="title" value="{{ request.GET.title }}" placeholder="Ex: Villa moderne" class="w-full border rounded px-3 py-2">
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-1">Ville</label>
                <input type="text" name="city" value="{{ request.GET.city }}" placeholder="Ex: Kinshasa" class="w-full border rounded px-3 py-2">
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-1">Prix min</label>
                <input type="number" name="min_price" value="{{ request.GET.min_price }}" placeholder="Ex: 1000" class="w-full border rounded px-3 py-2">
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-1">Prix max</label>
                <input type="number" name="max_price" value="{{ request.GET.max_price }}" placeholder="Ex: 10000" class="w-full border rounded px-3 py-2">
            </div>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-1">Chambres</label>
                <input type="number" name="bedrooms" value="{{ request.GET.bedrooms }}" placeholder="Ex: 3" class="w-full border rounded px-3 py-2">
            </div>

            <button type="submit" class="w-full bg-blue-600 text-white px-4 py-2 rounded">Filtrer</button>
        </form>
    </div>

    <!-- Liste des biens -->
    <div class="w-full md:flex-1 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for prop in page_obj %}
            <div class="bg-white rounded shadow p-4">
                <img src="{{ prop.main_image.url }}" alt="{{ prop.title }}" class="w-full h-48 object-cover rounded mb-2">
                <h3 class="text-lg font-bold">{{ prop.title }}</h3>
                <p class="text-sm text-gray-600">{{ prop.address }}</p>
                <p class="text-sm text-gray-800 mt-1 font-semibold">{{ prop.price }} $</p>
                <a href="{% url 'property_detail' prop.id %}" class="inline-block mt-2 text-blue-600 hover:underline">Voir plus</a>
            </div>
        {% empty %}
            <p class="col-span-3">Aucun bien trouvé.</p>
        {% endfor %}
    </div>
</div>

<!-- Pagination -->
<div class="mt-6 flex justify-center space-x-2">
    {% if page_obj.has_previous %}
        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page=1" class="px-3 py-1 bg-gray-200 rounded">« Première</a>
        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}" class="px-3 py-1 bg-gray-200 rounded">›</a>
    {% endif %}

    <span class="px-3 py-1 bg-blue-500 text-white rounded">
        Page {{ page_obj.number }} sur {{ page_obj.paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.next_page_number }}" class="px-3 py-1 bg-gray-200 rounded">›</a>
        <a href="?{% if request.GET %}{{ request.GET.urlencode }}&{% endif %}page={{ page_obj.paginator.num_pages }}" class="px-3 py-1 bg-gray-200 rounded">Dernière »</a>
    {% endif %}
</div>
{% endblock %}

